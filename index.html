<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Spirit Vox</title>
<style>
body {
  background: black;
  color: #0f0;
  font-family: monospace;
  text-align: center;
}
button, input {
  background: black;
  color: #0f0;
  border: 1px solid #0f0;
  padding: 10px;
  margin: 5px;
}
</style>
</head>

<body>

<h1>SPIRIT VOX</h1>
<p>Interferencia activa</p>

<button onclick="startVox()">INICIAR</button>
<button onclick="stopVox()">DETENER</button>

<br><br>
<label>Intensidad</label>
<input type="range" min="0.1" max="2" step="0.1" id="chaos" value="1">

<script>
let audioCtx;
let noiseSource;
let interval;

const words = [
  "hola", "ayuda", "ven", "aquí", "muerte",
  "escucha", "no", "sí", "estoy", "frío",
  "oscuro", "tiempo", "sal", "puerta", "detrás"
];

function startVox() {
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();

  // Ruido blanco (interferencia)
  const bufferSize = 2 * audioCtx.sampleRate;
  const noiseBuffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
  const output = noiseBuffer.getChannelData(0);

  for (let i = 0; i < bufferSize; i++) {
    output[i] = Math.random() * 2 - 1;
  }

  noiseSource = audioCtx.createBufferSource();
  noiseSource.buffer = noiseBuffer;
  noiseSource.loop = true;

  const noiseGain = audioCtx.createGain();
  noiseGain.gain.value = 0.2;

  noiseSource.connect(noiseGain).connect(audioCtx.destination);
  noiseSource.start();

  // Voces aleatorias
  interval = setInterval(() => {
    if (Math.random() > 0.6) speakRandom();
  }, 1000 / document.getElementById("chaos").value);
}

function speakRandom() {
  const utter = new SpeechSynthesisUtterance(
    words[Math.floor(Math.random() * words.length)]
  );
  utter.pitch = Math.random() * 2;
  utter.rate = 0.5 + Math.random();
  utter.volume = 0.2;
  speechSynthesis.speak(utter);
}

function stopVox() {
  clearInterval(interval);
  if (noiseSource) noiseSource.stop();
  speechSynthesis.cancel();
}
</script>

</body>
</html>